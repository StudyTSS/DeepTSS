# DeepTSS


This repository contains codes developped in order to find transcription start site (TSS) in a genome with a deep convolutional neural network (CNN).

The first step is to generate the data and to label them. 

Data_augmentation.ipynb can be uploaded to a jupyter notebook to generate 299 sequences of 299 base pair long around a TSS, with an offset of one base pair. Those sequences are positively labeled. Genes positions need to be stored in a csv file with columns precising the chromosome number, the start position, stop position and the strand (it takes the start position as TSS if the strand is positive and vice versa). The nucleotid sequences are stored in hdf5 files, one for each chromosome. Then we delete 299*2 bp of nucleotid at each side of every TSS and the reluctant gives the negatively labeled sequences. It gives a relatively balanced dataset of positively labeled sequences and negatively labeled sequences.

Data_treatement.ipynb can be used in a jupyter notebook to generate a sequence of 299 bp long around each TSS a. hose sequences are the positively labeled. It generates also n times more negatively labeled sequences that are taken randomly at more than 299 bp away from any TSS. Using this strategy we can create dataset of precise positive/negative ratio. Nucleotid sequence and genes position must be stored in the same manner as before.

DNN.ipynb can is used to train a CNN model to detect TSS. The first step is to get the sequence one-hot-incoded so that our sequences become 2D black and white images (299,4). It then splits the data in training, validation and testing sets. Keras sequentiel model is used to define a 3 convolutional layers, one dense layer with max pooling, LeakyRelu and dropout. It also prevents overfitting by an early stopping strategy (stopping the training after 10 epochs if no improvement in the validation loss has been shown). The best model obtained during training is stored in a hdf5 file. To evaluate the model it calculates the loss (binary crossentropy) and the metrics (accuracy and Mattew correlation coefficient) on the testing set. It also predicts TSS from the testing data and evaluates the area under the recall precision curve (AUPRC) and the receiver opperating characteristic (AUROC) using sklearn.

Prediction_TSS.ipynb is a jupyter notebook executable file to perform prediction of TSS on a whole genome. It creates a rolling window of 299 bp long with an offset of one and gives to each sequence a score (the probability of being a TSS). It calculates the zscore of the prediction score and summarized the results. Firstly, a matrix view of the zscore around every TSS gives a feeling of the accuracy of the prediction. Then it calculates the mean of the zscore at each positions (+/- 5000) around TSS, plots the curve and calculates the area under the curve.
